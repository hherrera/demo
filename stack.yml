version: "3"
services:
  web:
    image: hherrera1974/web01:prod
    ports:
      - 8800:80
    # service deployment
    deploy:
      # replicated or global
      mode: replicated
      replicas: 3
      # service resource management
      resources:
        # Hard limit - Docker does not allow to allocate more
        limits:
          cpus: '1'
          memory: 512M
        # Soft limit - Docker makes best effort to return to it
        reservations:
          cpus: '0.50'
          memory: 256M
      # service restart policy
      restart_policy:
        condition: on-failure
      # service update configuration
      update_config:
        parallelism: 1
      # placement constraint - 'worker' or 'manager'
      placement:
        constraints: [node.role == worker]
    labels:
          - "traefik.enable=true"
          - "traefik.port=8800"
          - "traefik.docker.network= traefik-net"
          - "traefik.frontend.rule= Host:demo.${CLUSTER_DOMAIN}"

         
          #volumes:
#  logs_nginx:
